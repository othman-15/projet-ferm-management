<div class="equipment-container">
  <div class="equipment-content">

    <!-- ========== HEADER ========== -->
    <div class="equipment-header">
      <div class="header-left">
        <button class="btn-back" (click)="goBack()">
          â† Retour
        </button>
        <div class="header-title-section">
          <h1 class="equipment-title">
            ğŸ”§ Ã‰quipements & Capteurs
          </h1>
          <p class="equipment-subtitle">
            GÃ©rez tous les Ã©quipements et capteurs de la ferme
          </p>
        </div>
      </div>
      <button
        *ngIf="hasRole('ADMIN')"
        class="btn-primary"
        (click)="createNewEquipment()">
        â• Nouvel Ã‰quipement
      </button>
    </div>

    <!-- ========== LOADING STATE ========== -->
    <div *ngIf="isLoading" class="loading-container">
      <div class="card">
        <div class="loading-spinner"></div>
        <p>Chargement des Ã©quipements...</p>
      </div>
    </div>

    <!-- ========== ERROR MESSAGE ========== -->
    <div *ngIf="errorMessage && !isLoading" class="error-banner">
      âš ï¸ {{ errorMessage }}
    </div>

    <!-- ========== CONTENT ========== -->
    <div *ngIf="!isLoading">

      <!-- Quick Stats -->
      <div class="stats-grid">
        <div class="stat-card stat-card-total">
          <div class="stat-icon">ğŸ”§</div>
          <div class="stat-content">
            <p class="stat-label">Total Ã‰quipements</p>
            <p class="stat-value">{{ equipments.length }}</p>
          </div>
        </div>
        <div class="stat-card stat-card-active">
          <div class="stat-icon">ğŸ“Š</div>
          <div class="stat-content">
            <p class="stat-label">Capteurs Actifs</p>
            <p class="stat-value">{{ getTotalCapteurs() }}</p>
          </div>
        </div>
        <div class="stat-card stat-card-tracteur">
          <div class="stat-icon">ğŸšœ</div>
          <div class="stat-content">
            <p class="stat-label">Tracteurs</p>
            <p class="stat-value">{{ countEquipmentsByType('TRACTEUR') }}</p>
          </div>
        </div>
        <div class="stat-card stat-card-irrigation">
          <div class="stat-icon">ğŸ’§</div>
          <div class="stat-content">
            <p class="stat-label">Irrigation</p>
            <p class="stat-value">{{ countEquipmentsByType('IRRIGATION') }}</p>
          </div>
        </div>
      </div>

      <!-- Empty State -->
      <div *ngIf="equipments.length === 0" class="card empty-state">
        <div class="empty-icon">ğŸ”§</div>
        <p class="empty-text">Aucun Ã©quipement disponible</p>
        <p class="empty-subtext">Commencez par ajouter votre premier Ã©quipement</p>
        <button
          *ngIf="hasRole('ADMIN')"
          class="btn-primary"
          (click)="createNewEquipment()">
          CrÃ©er le premier Ã©quipement
        </button>
      </div>

      <!-- Equipment Grid -->
      <div *ngIf="equipments.length > 0" class="equipments-grid">
        <div
          *ngFor="let equipment of equipments"
          class="equipment-card"
          (click)="viewEquipmentDetail(equipment.id)">

          <!-- Card Header -->
          <div class="equipment-header-card">
            <div class="equipment-type-badge" [ngClass]="getEquipmentTypeColor(equipment.type)">
              {{ getEquipmentTypeIcon(equipment.type) }} {{ getEquipmentTypeLabel(equipment.type) }}
            </div>
            <button
              *ngIf="hasRole('ADMIN')"
              class="btn-delete"
              (click)="deleteEquipment($event, equipment.id)"
              title="Supprimer">
              ğŸ—‘ï¸
            </button>
          </div>

          <!-- Equipment Info -->
          <h3 class="equipment-name">{{ equipment.nom }}</h3>
          <p class="equipment-description" *ngIf="equipment.description">
            {{ equipment.description }}
          </p>

          <!-- Equipment Details -->
          <div class="equipment-details">
            <div class="detail-item">
              <span class="detail-icon">ğŸ“…</span>
              <span class="detail-text">
                {{ equipment.dateInstallation | date: 'dd/MM/yyyy' }}
              </span>
            </div>
            <div class="detail-item">
              <span class="detail-icon">ğŸ“Š</span>
              <span class="detail-text">
                {{ equipment.nombreCapteurs || 0 }} capteur(s)
              </span>
            </div>
          </div>

          <!-- View Button -->
          <button class="btn-view">
            Voir les dÃ©tails â†’
          </button>
        </div>
      </div>

    </div>
  </div>
</div>
