<!-- Modal Overlay -->
<div *ngIf="isOpen" class="modal-overlay" (click)="closeModal()">

  <!-- Modal Content -->
  <div class="modal-content" (click)="$event.stopPropagation()">

    <!-- Modal Header -->
    <div class="modal-header">
      <h2 class="modal-title">
        üë®‚Äçüî¨ Affecter un Biologiste
      </h2>
      <button class="modal-close" (click)="closeModal()">
        ‚úï
      </button>
    </div>

    <!-- Loading State -->
    <div *ngIf="isLoading" class="modal-loading">
      <div class="loading-spinner"></div>
      <p>Chargement des biologistes...</p>
    </div>

    <!-- Error Message -->
    <div *ngIf="errorMessage" class="error-banner">
      ‚ö†Ô∏è {{ errorMessage }}
    </div>

    <!-- Form -->
    <form *ngIf="!isLoading" [formGroup]="assignForm" (ngSubmit)="onSubmit()" class="modal-form">

      <!-- Select Biologiste -->
      <div class="form-group">
        <label for="biologisteId" class="form-label">
          S√©lectionner un Biologiste <span class="required">*</span>
        </label>
        <select
          id="biologisteId"
          formControlName="biologisteId"
          class="input-field">
          <option value="">-- Choisir un biologiste --</option>
          <option *ngFor="let biologiste of biologistes" [value]="biologiste.id">
            {{ biologiste.nom }}
            <span *ngIf="biologiste.specialite"> - {{ biologiste.specialite }}</span>
          </option>
        </select>
      </div>

      <!-- R√¥le dans le Projet -->
      <div class="form-group">
        <label for="roleDansProjet" class="form-label">
          R√¥le dans le Projet <span class="required">*</span>
        </label>
        <input
          type="text"
          id="roleDansProjet"
          formControlName="roleDansProjet"
          class="input-field"
          placeholder="Ex: Chef de projet, Analyste, Consultant...">
        <span class="help-text">
          Sp√©cifiez le r√¥le ou la responsabilit√© du biologiste
        </span>
      </div>

      <!-- Date d'Affectation -->
      <div class="form-group">
        <label for="dateAffectation" class="form-label">
          Date d'Affectation <span class="required">*</span>
        </label>
        <input
          type="date"
          id="dateAffectation"
          formControlName="dateAffectation"
          class="input-field">
      </div>

      <!-- Modal Actions -->
      <div class="modal-actions">
        <button
          type="button"
          class="btn-outline"
          (click)="closeModal()"
          [disabled]="isSubmitting">
          Annuler
        </button>
        <button
          type="submit"
          class="btn-primary"
          [disabled]="isSubmitting || assignForm.invalid">
          <span *ngIf="!isSubmitting">
            ‚úÖ Affecter
          </span>
          <span *ngIf="isSubmitting">
            ‚è≥ Affectation...
          </span>
        </button>
      </div>

    </form>

  </div>
</div>
